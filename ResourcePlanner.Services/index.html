<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" ng-app="app">
<head>
    <title></title>

    <script src="Scripts/angular.js"></script>
    <script src="Scripts/angular-animate.js"></script>
    <script src="Scripts/angular-route.js"></script>

    <script src="http://ajax.googleapis.com/ajax/libs/angularjs/1.4.3/angular-touch.js"></script>

    <script src="Scripts/ui-grid.js"></script>
    <link rel="stylesheet" href="Scripts/ui-grid.css" />
    <script src="App/app.js"></script>

    <script src="http://ui-grid.info/docs/grunt-scripts/csv.js"></script>
    <script src="http://ui-grid.info/docs/grunt-scripts/pdfmake.js"></script>
    <script src="http://ui-grid.info/docs/grunt-scripts/vfs_fonts.js"></script>

    <script>
        var app = angular.module('app', ['ngTouch', 'ui.grid']);

        app.controller('MainCtrl', ['$scope', '$http', '$timeout', function ($scope, $http, $timeout) {

            $scope.getFirstData = function() {
                return $http.get('http://localhost:1620/api/resource')
                .then(function (response) {
                    var result = [response.data.Resources.length];

                    for (var i = 0; i < response.data.Resources.length; i++) {
                        var row = {};
                        var currentObject = response.data.Resources[i];

                        row.FirstName = currentObject.FirstName;
                        row.LastName = currentObject.LastName;
                        row.City = currentObject.City;
                        row.Position = currentObject.Position;

                        for (var j = 0; j < response.data.TimePeriods.length; j++) {
                            row[response.data.TimePeriods[j]] = j;
                        }

                        result[i] = row;

                    }



                    $scope.myData = result;
                });
            };

            $scope.getFirstData();
        }]);
    </script>

</head>
<body>
    <div ng-controller="MainCtrl">
        <div id="grid1" ui-grid="{ data: myData }" class="grid"></div>
    </div>

</body>
</html>
